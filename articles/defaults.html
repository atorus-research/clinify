<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Setting Clinify Defaults • clinify</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Setting Clinify Defaults">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-165685385-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-165685385-2');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clinify</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/clinify.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/defaults.html">Setting Clinify Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/pagination.html">Pagination</a></li>
    <li><a class="dropdown-item" href="../articles/titles_footnotes.html">Titles and Footnotes</a></li>
    <li><a class="dropdown-item" href="../articles/write.html">Document Objects and Saving</a></li>
    <li><a class="dropdown-item" href="../articles/end_to_end.html">End-to-End Example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/atorus-research/clinify/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Setting Clinify Defaults</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atorus-research/clinify/blob/main/vignettes/defaults.Rmd" class="external-link"><code>vignettes/defaults.Rmd</code></a></small>
      <div class="d-none name"><code>defaults.Rmd</code></div>
    </div>

    
    
<p>Organizations likely have their own default styles for their clinical
tables. Standards likely exist for things such as default page size and
orientation, margins, fonts and font sizes. Furthermore, these settings
might different between the table body, titles, footnotes. These are
things that you likely don’t want to have to pre-specify in every
individual program. Furthermore, perhaps a style needs to be broadly
updated across an entire study, or organization wide. These are settings
that are ideally consolidated into one place and applied across
potentially dozens of programs. For this reason,
<strong>{clinify}</strong> has the option to configure - or additionally
override - the default styles applied to a table.</p>
<p><strong>{clinify}</strong> loads defaults into multiple options on
package load. These options include the following:</p>
<ul>
<li>
<code>clinify_docx_default</code>: An {officer}
<code>prop_section</code> object that stores the document defaults,
including margins, page size, and orientation</li>
<li>
<code>clinify_titles_default</code>: The {flextable} styles applied
to the title section that goes in the header of the word document</li>
<li>
<code>clinify_footnotes_default</code>: The {flextable} styles
applied to the footnotes that go in the footer of the word document</li>
<li>
<code>clinify_table_default</code>: The {flextable} styles applied
to the body of the table</li>
<li>
<code>clinify_caption_default</code>: {flextable} styles applied to
captions (in body footnotes applied to tables, see
<code><a href="../reference/clin_group_by.html">clin_group_by()</a></code>)</li>
</ul>
<div class="section level2">
<h2 id="creating-setting-functions">Creating Setting Functions<a class="anchor" aria-label="anchor" href="#creating-setting-functions"></a>
</h2>
<p>The following sections are the functions which exist in clinify
itself. If you wish to override any of these functions, you can create
your own version of the function and apply to associated option.</p>
<div class="section level3">
<h3 id="clinify_docx_default">
<code>clinify_docx_default</code><a class="anchor" aria-label="anchor" href="#clinify_docx_default"></a>
</h3>
<p>The default of <strong>{clinify}</strong> generally follows a
landscape A4 style page. This is the default of {officer}, but in this
example we override the page size of the <code>prop_section</code> to be
landscape, so the margins get lost. It’s necessary to have the margins
available for the calculations used in
<code><a href="../reference/clin_col_widths.html">clin_col_widths()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinify_docx_default</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># I want these as defaults but need to carry it forward because</span></span>
<span>  <span class="co"># the default section strips it off</span></span>
<span>  <span class="va">margins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/docx_dim.html" class="external-link">docx_dim</a></span><span class="op">(</span><span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/read_docx.html" class="external-link">read_docx</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">margins</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gutter <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/prop_section.html" class="external-link">prop_section</a></span><span class="op">(</span></span>
<span>    page_size <span class="op">=</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/page_size.html" class="external-link">page_size</a></span><span class="op">(</span>orient <span class="op">=</span> <span class="st">"landscape"</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>    page_margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="fu">officer</span><span class="fu">::</span><span class="va"><a href="https://davidgohel.github.io/officer/reference/page_mar.html" class="external-link">page_mar</a></span>, <span class="va">margins</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clinify_titles_default-and-clin_footnotes_default">
<code>clinify_titles_default</code> and
<code>clin_footnotes_default()</code><a class="anchor" aria-label="anchor" href="#clinify_titles_default-and-clin_footnotes_default"></a>
</h3>
<p>Note the function <code><a href="../reference/clin_replace_pagenums.html">clin_replace_pagenums()</a></code>. All of this
styling applies during either print or the creation of the
<code>rdocx</code> object so the table can be rendered to word. The
<code><a href="../reference/clin_replace_pagenums.html">clin_replace_pagenums()</a></code> function will look for the fields
<code>{PAGE}</code> and <code>{NUMPAGES}</code> and replace them with
the Word auto fields for current page and total pages respectively. This
allows you to be flexible with how you specify the page numbers should
look.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinify_titles_default</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Remove all borders as heading does not need any.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/border_remove.html" class="external-link">border_remove</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="co"># Setup font properties.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/color.html" class="external-link">color</a></span><span class="op">(</span><span class="va">x</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html" class="external-link">fontsize</a></span><span class="op">(</span><span class="va">x</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/font.html" class="external-link">font</a></span><span class="op">(</span><span class="va">x</span>, font <span class="op">=</span> <span class="st">"Courier New"</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/bold.html" class="external-link">bold</a></span><span class="op">(</span><span class="va">x</span>, bold <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/italic.html" class="external-link">italic</a></span><span class="op">(</span><span class="va">x</span>, italic <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Default table width</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/width.html" class="external-link">width</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fu"><a href="../reference/clin_default_table_width.html">clin_default_table_width</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="co"># Setup the interval between rows.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/line_spacing.html" class="external-link">line_spacing</a></span><span class="op">(</span><span class="va">x</span>, space <span class="op">=</span> <span class="fl">1</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span>  <span class="co"># Setup the cell padding.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/padding.html" class="external-link">padding</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"all"</span>, padding.bottom <span class="op">=</span> <span class="fl">0</span>, padding.top <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html" class="external-link">set_table_properties</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    layout <span class="op">=</span> <span class="st">"fixed"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># Automatically find and update a pagenum string</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clin_replace_pagenums.html">clin_replace_pagenums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">clinify_footnotes_default</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Remove all borders.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/border_remove.html" class="external-link">border_remove</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="co"># Page footer should have single top border over the top row.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/hline_top.html" class="external-link">hline_top</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    part <span class="op">=</span> <span class="st">"body"</span>,</span>
<span>    border <span class="op">=</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">fp_border</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># Setup font properties.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/color.html" class="external-link">color</a></span><span class="op">(</span><span class="va">x</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html" class="external-link">fontsize</a></span><span class="op">(</span><span class="va">x</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/font.html" class="external-link">font</a></span><span class="op">(</span><span class="va">x</span>, font <span class="op">=</span> <span class="st">"Courier New"</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/bold.html" class="external-link">bold</a></span><span class="op">(</span><span class="va">x</span>, bold <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/italic.html" class="external-link">italic</a></span><span class="op">(</span><span class="va">x</span>, italic <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="co"># One has to specify the width of the page header "table", which in this case</span></span>
<span>  <span class="co"># is landscape page width minus two times 1 in margin.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/width.html" class="external-link">width</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fu"><a href="../reference/clin_default_table_width.html">clin_default_table_width</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="co"># Setup the interval between rows.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/line_spacing.html" class="external-link">line_spacing</a></span><span class="op">(</span><span class="va">x</span>, space <span class="op">=</span> <span class="fl">1</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span>  <span class="co"># Setup the cell padding.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/padding.html" class="external-link">padding</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"all"</span>, padding.bottom <span class="op">=</span> <span class="fl">0</span>, padding.top <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html" class="external-link">set_table_properties</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    layout <span class="op">=</span> <span class="st">"fixed"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># Automatically find and update a pagenum string</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clin_replace_pagenums.html">clin_replace_pagenums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clinify_table_default">
<code>clinify_table_default</code><a class="anchor" aria-label="anchor" href="#clinify_table_default"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinify_table_default</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Clear all borders first and apply them just for the header</span></span>
<span>  <span class="co"># (as horizontal lines).</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/border_remove.html" class="external-link">border_remove</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/hline.html" class="external-link">hline</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    part <span class="op">=</span> <span class="st">"header"</span>,</span>
<span>    border <span class="op">=</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">fp_border</a></span><span class="op">(</span></span>
<span>      color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      style <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>      width <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># Top horizontal line for the table header.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/hline_top.html" class="external-link">hline_top</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/hline.html" class="external-link">hline</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"header"</span>, border <span class="op">=</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">fp_border</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Remove blank bottoms</span></span>
<span>  <span class="va">blk_inds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span><span class="op">$</span><span class="va">header</span><span class="op">$</span><span class="va">dataset</span> <span class="op">==</span> <span class="st">""</span> <span class="op">|</span> <span class="va">x</span><span class="op">$</span><span class="va">header</span><span class="op">$</span><span class="va">dataset</span> <span class="op">==</span> <span class="st">" "</span>,</span>
<span>    arr.ind <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># Want to ignore bottom row</span></span>
<span>  <span class="va">blk_inds</span> <span class="op">&lt;-</span> <span class="va">blk_inds</span><span class="op">[</span></span>
<span>    <span class="va">blk_inds</span><span class="op">[</span>, <span class="st">"row"</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">header</span><span class="op">$</span><span class="va">dataset</span><span class="op">)</span>,</span>
<span>    ,</span>
<span>    drop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">blk_inds</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Loop all except very bottom row</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">blk_inds</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/hline.html" class="external-link">hline</a></span><span class="op">(</span></span>
<span>        <span class="va">x</span>,</span>
<span>        i <span class="op">=</span> <span class="va">blk_inds</span><span class="op">[</span><span class="va">i</span>, <span class="st">"row"</span><span class="op">]</span>,</span>
<span>        j <span class="op">=</span> <span class="va">blk_inds</span><span class="op">[</span><span class="va">i</span>, <span class="st">"col"</span><span class="op">]</span>,</span>
<span>        part <span class="op">=</span> <span class="st">"header"</span>,</span>
<span>        border <span class="op">=</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">fp_border</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"none"</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># Bottom border</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/hline_bottom.html" class="external-link">hline_bottom</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Set font properties for the table header.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/font.html" class="external-link">font</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"all"</span>, fontname <span class="op">=</span> <span class="st">"Courier New"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Set fontsize for both table header and table body.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html" class="external-link">fontsize</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"all"</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Set table's layout.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html" class="external-link">set_table_properties</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    layout <span class="op">=</span> <span class="st">"fixed"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clinify_grouplabel_default">
<code>clinify_grouplabel_default</code><a class="anchor" aria-label="anchor" href="#clinify_grouplabel_default"></a>
</h3>
<p>Note that this option is only necessary because of how captions are
applied by <code><a href="../reference/clin_group_by.html">clin_group_by()</a></code>. The caption doesn’t bind to the
table object until the pagination is being processed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinify_grouplabel_default</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Remove top line above group label</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/hline_top.html" class="external-link">hline_top</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    part <span class="op">=</span> <span class="st">"header"</span>,</span>
<span>    border <span class="op">=</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">fp_border</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"none"</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clinify_caption_default">
<code>clinify_caption_default</code><a class="anchor" aria-label="anchor" href="#clinify_caption_default"></a>
</h3>
<p>Note that this option is only necessary because of how captions are
applied by <code><a href="../reference/clin_group_by.html">clin_group_by()</a></code>. The caption doesn’t bind to the
table object until the pagination is being processed. As such, the
“footer” of the flextable object itself can’t have styles applied until
the footer is set.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinify_caption_default</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Set font properties for the table header.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/font.html" class="external-link">font</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"footer"</span>, fontname <span class="op">=</span> <span class="st">"Courier New"</span><span class="op">)</span></span>
<span>  <span class="co"># Set fontsize for both table header and table body.</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html" class="external-link">fontsize</a></span><span class="op">(</span><span class="va">x</span>, part <span class="op">=</span> <span class="st">"footer"</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="applying-the-options">Applying the Options<a class="anchor" aria-label="anchor" href="#applying-the-options"></a>
</h2>
<p>Once you have the function created, the options can be applied as
follows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  clinify_docx_default <span class="op">=</span> <span class="va">sect</span>,</span>
<span>  clinify_titles_default <span class="op">=</span> <span class="va">clinify_titles_default</span>,</span>
<span>  clinify_footnotes_default <span class="op">=</span> <span class="va">clinify_footnotes_default</span>,</span>
<span>  clinify_table_default <span class="op">=</span> <span class="va">clinify_table_default</span>,</span>
<span>  clinify_caption_default <span class="op">=</span> <span class="va">clinify_caption_default</span>,</span>
<span>  clinify_grouplabel_default <span class="op">=</span> <span class="va">clinify_grouplabel_default</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mike Stackhouse, Ross Didenko, Yevhenii Boiko.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
